<!doctype html>
<html lang="zh-CN">
  <head>
    <meta charset="UTF-8" />
    <title>æ™ºèƒ½ç®¡ç†é¢æ¿</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link
      rel="icon"
      type="image/svg+xml"
      href="https://pic.want.biz/favicon.svg"
    />
    <link rel="alternate icon" href="https://pic.want.biz/favicon.svg" />
    <script>
      //--CONFIG-PLACEHOLDER--//
    </script>
    <style>
      /* ====== THEME VARIABLES ====== */
      :root {
        /* æµ…è‰²é»˜è®¤å€¼ */
        --bg: #f8f9fa;
        --bg-panel: #ffffff;
        --text: #2c3e50;
        --text-sub: #6c757d;
        --border: #e9ecef;
        --accent: #667eea;
        --accent2: #764ba2;
        --shadow: rgba(0, 0, 0, 0.08);
        --success: #2ecc71;
        --warning: #f39c12;
        --error: #e74c3c;
        --info: #3498db;
        transition:
          background-color 0.3s,
          color 0.3s;
      }
      [data-theme='dark'] {
        --bg: #111827;
        --bg-panel: #1f2937;
        --text: #f9fafb;
        --text-sub: #9ca3af;
        --border: #374151;
        --accent: #818cf8;
        --accent2: #a78bfa;
        --shadow: rgba(0, 0, 0, 0.4);
        --success: #10b981;
        --warning: #f59e0b;
        --error: #ef4444;
        --info: #3b82f6;
      }

      /* ====== Base Styles ====== */
      * {
        box-sizing: border-box;
        margin: 0;
        padding: 0;
      }
      body {
        font-family:
          -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto,
          'Helvetica Neue', Arial, sans-serif;
        background: linear-gradient(
          135deg,
          var(--accent) 0%,
          var(--accent2) 100%
        );
        padding: 20px;
        min-height: 100vh;
        overflow-y: auto;
      }
      .container {
        width: 100%;
        max-width: 1200px;
        margin: 20px auto;
        background: color-mix(in srgb, var(--bg-panel) 95%, transparent);
        backdrop-filter: blur(10px);
        padding: 30px;
        border-radius: 20px;
        box-shadow: 0 20px 40px var(--shadow);
        display: flex;
        flex-direction: column;
        gap: 20px;
      }
      h1 {
        text-align: center;
        color: var(--text);
        margin: 0 0 8px;
        font-size: 2.2em;
        font-weight: 700;
        background: linear-gradient(45deg, var(--accent), var(--accent2));
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
        background-clip: text;
      }

      /* ====== Tabs Styles ====== */
      .tabs {
        display: flex;
        justify-content: center;
        margin-bottom: 8px;
        border-bottom: 2px solid var(--border);
        padding-bottom: 5px;
        gap: 10px;
      }
      .tab-button {
        background: var(--bg);
        border: 1px solid var(--border);
        padding: 10px 15px;
        cursor: pointer;
        font-size: 0.95em;
        font-weight: 600;
        color: var(--text-sub);
        transition: all 0.3s ease;
        border-radius: 10px 10px 0 0;
        box-shadow: 0 2px 8px var(--shadow);
        position: relative;
        overflow: hidden;
      }
      .tab-button:hover {
        background: var(--bg-panel);
        color: var(--accent);
        transform: translateY(-2px);
        box-shadow: 0 4px 15px var(--shadow);
      }
      .tab-button.active {
        background: linear-gradient(
          135deg,
          var(--accent) 0%,
          var(--accent2) 100%
        );
        color: white;
        border-color: var(--accent);
        border-bottom: 2px solid var(--accent);
        box-shadow: 0 4px 15px
          color-mix(in srgb, var(--accent) 30%, transparent);
        transform: translateY(0);
      }
      .tab-button.active:hover {
        transform: translateY(0);
      }
      .tab-content {
        display: none;
        padding-top: 8px;
      }
      .tab-content.active {
        display: block;
      }

      /* ====== General Section Styles ====== */
      .section-box {
        background: var(--bg-panel);
        border: 1px solid var(--border);
        border-radius: 16px;
        padding: 16px;
        box-shadow: 0 4px 20px var(--shadow);
        display: flex;
        flex-direction: column;
        gap: 12px;
        transition: all 0.3s ease;
        margin-bottom: 16px;
      }
      .section-box h2,
      .section-box h3 {
        margin: 0;
        font-size: 1.2em;
        color: var(--text);
        font-weight: 600;
        border-bottom: 1px solid var(--border);
        padding-bottom: 8px;
        margin-bottom: 12px;
        /* ç¡®ä¿æ ‡é¢˜åœ¨å°å±å¹•ä¸Šæ¢è¡Œ */
        word-break: break-word;
        overflow-wrap: break-word;
      }
      .section-box h3 {
        font-size: 1em;
        font-weight: 500;
        border-bottom: none;
        padding-bottom: 0;
        margin-bottom: 8px;
      }
      .section-box p {
        color: var(--text-sub);
        margin-bottom: 8px;
        font-size: 0.9em;
        word-break: break-word; /* ç¡®ä¿æ®µè½æ–‡æœ¬æ¢è¡Œ */
        overflow-wrap: break-word;
      }
      .section-box ul {
        list-style: none;
        padding: 0;
        margin: 0;
        border: 1px solid var(--border);
        border-radius: 8px;
        max-height: 200px;
        overflow-y: auto;
        background: var(--bg);
      }
      .section-box li {
        padding: 8px 12px;
        border-bottom: 1px solid var(--border);
        color: var(--text);
        font-size: 0.9em;
        word-break: break-word; /* ç¡®ä¿åˆ—è¡¨é¡¹æ–‡æœ¬æ¢è¡Œ */
        overflow-wrap: break-word;
      }
      .section-box li:last-child {
        border-bottom: none;
      }
      .section-box pre {
        background: var(--bg);
        padding: 12px;
        border-radius: 8px;
        white-space: pre-wrap;
        word-wrap: break-word;
        font-family: 'Courier New', Courier, monospace;
        font-size: 0.85em;
        max-height: 150px;
        overflow-y: auto;
        color: var(--text-sub);
        border: 1px solid var(--border);
        word-break: break-word; /* ç¡®ä¿é¢„æ ¼å¼æ–‡æœ¬æ¢è¡Œ */
        overflow-wrap: break-word;
      }
      .section-box textarea {
        min-height: 80px;
        resize: vertical;
        width: 100%;
        padding: 10px;
        border: 2px solid var(--border);
        border-radius: 12px;
        font-size: 0.95em;
        background: linear-gradient(135deg, var(--bg) 0%, var(--bg-panel) 100%);
        color: var(--text);
        transition: all 0.3s ease;
        box-shadow: 0 2px 10px var(--shadow);
      }
      .section-box textarea:focus {
        outline: none;
        border-color: var(--accent);
        box-shadow:
          0 0 0 4px color-mix(in srgb, var(--accent) 10%, transparent),
          0 4px 20px var(--shadow);
        background: var(--bg-panel);
        transform: translateY(-2px);
      }
      .input-with-clear {
        position: relative;
        display: block; /* Ensures it takes full width when inside a flex column */
        width: 100%; /* Explicitly set width for robustness */
      }
      .input-with-clear textarea {
        padding-right: 35px;
      }
      .input-clear-btn {
        position: absolute;
        top: 10px;
        right: 10px;
        width: 20px;
        height: 20px;
        border: none;
        background: var(--text-sub);
        color: var(--bg);
        border-radius: 50%;
        font-size: 14px;
        cursor: pointer;
        display: none;
        align-items: center;
        justify-content: center;
        opacity: 0.7;
        transition: all 0.2s ease;
        z-index: 10;
      }
      .input-clear-btn:hover {
        opacity: 1;
        background: var(--error);
        transform: scale(1.1);
      }
      .input-clear-btn:active {
        transform: scale(0.9);
      }
      .section-box .form-group {
        margin-bottom: 0;
        gap: 8px;
      }
      .section-box button {
        padding: 8px 12px;
        font-size: 0.85em;
        border-radius: 8px;
      }
      .section-box .delete-button {
        background: linear-gradient(135deg, #e74c3c 0%, #c0392b 100%);
      }
      .section-box .delete-button:hover {
        background: linear-gradient(135deg, #c0392b 0%, #a03020 100%);
      }
      .section-box.highlighted {
        background: linear-gradient(
          to bottom right,
          color-mix(in srgb, var(--accent) 5%, var(--bg-panel)),
          color-mix(in srgb, var(--accent2) 5%, var(--bg-panel))
        );
        border: 2px solid var(--accent);
        box-shadow: 0 8px 30px
          color-mix(in srgb, var(--accent) 25%, var(--shadow));
        transform: translateY(-2px);
      }

      /* ====== Form & Button Styles ====== */
      .controls,
      .form-group {
        display: flex;
        gap: 12px;
        align-items: stretch;
        width: 100%;
        margin-bottom: 12px;
      }
      input[type='text'],
      select {
        flex-grow: 1;
        padding: 12px 16px;
        border: 2px solid var(--border);
        border-radius: 12px;
        font-size: 0.95em;
        background: linear-gradient(135deg, var(--bg) 0%, var(--bg-panel) 100%);
        color: var(--text);
        transition: all 0.3s ease;
        box-shadow: 0 2px 10px var(--shadow);
        height: 44px;
        box-sizing: border-box;
      }
      input[type='text']::placeholder {
        color: var(--text-sub);
      }
      input[type='text']:focus,
      select:focus {
        outline: none;
        border-color: var(--accent);
        box-shadow:
          0 0 0 4px color-mix(in srgb, var(--accent) 10%, transparent),
          0 4px 20px var(--shadow);
        background: var(--bg-panel);
        transform: translateY(-2px);
      }
      button {
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        color: white;
        border: none;
        padding: 12px 18px;
        border-radius: 12px;
        cursor: pointer;
        font-size: 0.95em;
        font-weight: 600;
        transition: all 0.3s ease;
        flex-shrink: 0;
        box-shadow: 0 4px 15px rgba(102, 126, 234, 0.3);
        position: relative;
        overflow: hidden;
      }
      button::before {
        content: '';
        position: absolute;
        top: 0;
        left: -100%;
        width: 100%;
        height: 100%;
        background: linear-gradient(
          90deg,
          transparent,
          rgba(255, 255, 255, 0.2),
          transparent
        );
        transition: left 0.5s;
      }
      button:hover::before {
        left: 100%;
      }
      button:hover {
        transform: translateY(-2px);
        box-shadow: 0 8px 25px
          color-mix(in srgb, var(--accent) 40%, transparent);
      }
      button:active {
        transform: translateY(0);
        box-shadow: 0 4px 15px
          color-mix(in srgb, var(--accent) 30%, transparent);
      }
      button:disabled {
        background: linear-gradient(135deg, #bdc3c7 0%, #95a5a6 100%);
        cursor: not-allowed;
        transform: none;
        box-shadow: none;
      }

      .clear-button {
        background: linear-gradient(135deg, #ff6b6b 0%, #ff5252 100%);
        box-shadow: 0 4px 15px rgba(255, 107, 107, 0.3);
      }
      .clear-button:hover {
        background: linear-gradient(135deg, #ff5252 0%, #ff3d3d 100%);
        box-shadow: 0 8px 25px rgba(255, 82, 82, 0.4);
      }
      .submit-button {
        background: linear-gradient(
          135deg,
          var(--success) 0%,
          var(--accent) 100%
        );
        font-size: 1em !important;
        padding: 12px 20px !important;
        border-radius: 12px !important;
        font-weight: 600;
        letter-spacing: 0.5px;
        box-shadow: 0 8px 25px
          color-mix(in srgb, var(--success) 30%, var(--shadow));
      }
      .submit-button:hover {
        transform: translateY(-3px) !important;
        box-shadow: 0 12px 30px
          color-mix(in srgb, var(--success) 50%, var(--shadow)) !important;
      }
      .refresh-button {
        background: linear-gradient(135deg, var(--info) 0%, var(--accent2) 70%);
      }

      /* ====== Status & Tags ====== */
      #status-message,
      .status-display {
        text-align: center;
        min-height: 24px;
        padding: 10px 14px;
        font-size: 0.9em;
        transition: all 0.3s ease;
        border-radius: 8px;
        font-weight: 500;
        margin-bottom: 12px;
      }
      .status-success {
        color: var(--success);
        background: color-mix(in srgb, var(--success) 10%, transparent);
        border: 1px solid color-mix(in srgb, var(--success) 20%, transparent);
      }
      .status-error {
        color: var(--error);
        background: color-mix(in srgb, var(--error) 10%, transparent);
        border: 1px solid color-mix(in srgb, var(--error) 20%, transparent);
      }
      .status-info {
        color: var(--info);
        background: color-mix(in srgb, var(--info) 10%, transparent);
        border: 1px solid color-mix(in srgb, var(--info) 20%, transparent);
      }
      .status-tag {
        display: inline-block;
        padding: 4px 8px;
        border-radius: 6px;
        font-size: 0.8em;
        font-weight: 600;
        margin-right: 6px;
      }
      .status-tag.success {
        background-color: color-mix(in srgb, var(--success) 20%, transparent);
        color: var(--success);
        border: 1px solid var(--success);
      }
      .status-tag.error {
        background-color: color-mix(in srgb, var(--error) 20%, transparent);
        color: var(--error);
        border: 1px solid var(--error);
      }
      .status-tag.pending {
        background-color: color-mix(in srgb, var(--warning) 20%, transparent);
        color: var(--warning);
        border: 1px solid var(--warning);
      }
      .status-tag.processing {
        background-color: color-mix(in srgb, var(--accent) 20%, transparent);
        color: var(--accent);
        border: 1px solid var(--accent);
        animation: pulse 1.5s infinite;
      }
      @keyframes pulse {
        0%,
        100% {
          opacity: 1;
        }
        50% {
          opacity: 0.7;
        }
      }

      /* ====== Inspiration/News Card Styles ====== */
      .inspiration-grid {
        display: grid;
        grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
        gap: 16px;
        margin-top: 8px;
      }
      .inspiration-card {
        background: var(--bg-panel);
        border: 1px solid var(--border);
        border-radius: 12px;
        padding: 16px;
        transition: all 0.3s ease;
        position: relative;
        box-shadow: 0 4px 12px var(--shadow);
        font-size: 0.9em;
        display: flex;
        flex-direction: column;
        gap: 10px;
      }
      .inspiration-card:hover {
        transform: translateY(-5px);
        box-shadow: 0 8px 16px var(--shadow);
        border-color: var(--accent);
      }
      .inspiration-card-header {
        display: flex;
        justify-content: space-between;
        align-items: flex-start;
        gap: 8px;
      }
      .inspiration-card-title {
        color: var(--text);
        font-size: 1em;
        font-weight: 600;
        line-height: 1.4;
        margin: 0;
        flex: 1;
        word-break: break-word;
        overflow-wrap: break-word;
      }
      .inspiration-card-source {
        font-size: 0.75em;
        color: var(--text-sub);
        background: var(--bg);
        padding: 3px 8px;
        border-radius: 20px;
        white-space: nowrap;
      }
      .inspiration-card-description {
        font-size: 0.85em;
        color: var(--text-sub);
        margin: 0;
        line-height: 1.5;
        flex-grow: 1;
        word-break: break-word;
        overflow-wrap: break-word;
      }
      .inspiration-card-actions {
        display: flex;
        justify-content: space-between;
        gap: 8px;
        padding-top: 8px;
        border-top: 1px solid var(--border);
      }
      .inspiration-card-actions button {
        padding: 6px 12px;
        font-size: 0.8em;
        border-radius: 8px;
        flex: 1;
        min-width: 0;
      }

      /* ====== Specific Tab Content ====== */
      .section-container {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
        gap: 16px;
        margin-top: 0;
      }
      .latest-result {
        background: linear-gradient(
          135deg,
          color-mix(in srgb, var(--success) 10%, var(--bg)),
          color-mix(in srgb, var(--accent) 5%, var(--bg))
        );
        border: 2px solid var(--success);
        border-radius: 12px;
        padding: 16px;
        margin-bottom: 16px;
        box-shadow: 0 6px 20px
          color-mix(in srgb, var(--success) 20%, var(--shadow));
        animation: glow 2s ease-in-out infinite alternate;
      }
      .latest-result.error {
        background: linear-gradient(
          135deg,
          color-mix(in srgb, var(--error) 10%, var(--bg)),
          color-mix(in srgb, var(--bg) 98%, var(--error))
        );
        border: 2px solid var(--error);
        box-shadow: 0 6px 20px
          color-mix(in srgb, var(--error) 20%, var(--shadow));
      }
      /* Ensure content inside latest-result-content wraps */
      #latest-result-content div {
        word-break: break-word;
        overflow-wrap: break-word;
      }

      @keyframes glow {
        from {
          box-shadow: 0 6px 20px
            color-mix(in srgb, var(--accent) 20%, var(--shadow));
        }
        to {
          box-shadow: 0 8px 25px
            color-mix(in srgb, var(--accent) 40%, var(--shadow));
        }
      }
      .theme-toggle-btn {
        position: absolute;
        top: 50%;
        right: 0;
        transform: translateY(-50%);
        background: none;
        border: 1px solid var(--border);
        color: var(--text-sub);
        width: 36px;
        height: 36px;
        border-radius: 50%;
        font-size: 16px;
        cursor: pointer;
        transition: all 0.3s ease;
        display: flex;
        align-items: center;
        justify-content: center;
      }
      .theme-toggle-btn:hover {
        background-color: var(--bg);
        border-color: var(--accent);
        color: var(--accent);
      }

      /* ====== Responsive ====== */
      @media (max-width: 768px) {
        body {
          padding: 8px;
        }
        .container {
          padding: 16px;
          margin: 10px auto;
          gap: 16px;
        }
        h1 {
          font-size: 1.6em;
        }
        .section-container,
        .inspiration-grid {
          grid-template-columns: 1fr; /* Force single column layout */
        }
        .tabs {
          flex-wrap: wrap;
          justify-content: flex-start; /* Align tabs to start, allows wrapping */
        }
        .tab-button {
          flex: 1 0 auto; /* Allow buttons to grow/shrink based on content, wrap if needed */
          font-size: 0.9em;
          padding: 8px 12px;
          min-width: unset; /* Remove explicit min-width */
          max-width: 100%; /* Ensure it doesn't try to be too wide */
        }

        /* FIX FOR MOBILE OVERFLOW AND LAYOUT:
     * Force inputs, selects, and buttons to stack vertically and take full width
     * within their respective form-group/controls containers.
     */
        .controls,
        .form-group {
          flex-direction: column; /* Stack items vertically */
          gap: 8px; /* Consistent spacing between stacked items */
          align-items: stretch; /* Make children fill the width */
          margin-bottom: 12px; /* Maintain spacing with other sections */
          width: 100%; /* Ensure the flex container itself takes full width */
        }

        /* Ensure inputs and selects always take full width */
        input[type='text'],
        select {
          width: 100%; /* Explicitly set width to 100% */
          min-width: 0; /* Allow shrinking if parent has constraints */
          flex-shrink: 1; /* Allow to shrink */
          flex-grow: 1; /* Allow to grow */
          margin-bottom: 0; /* Let gap handle spacing */
        }

        /* Ensure textarea also takes full width */
        .section-box textarea {
          width: 100%;
          min-width: 0;
        }

        /* Ensure the input-with-clear wrapper takes full width */
        .input-with-clear {
          width: 100%; /* Force full width */
          flex: 1 1 auto; /* Be flexible within its parent, allows shrinking */
          min-width: 0; /* Prevent overflow */
        }

        /* Ensure buttons also take full width when stacked vertically */
        .form-group button,
        .controls button {
          width: 100%; /* Explicitly set button width to 100% */
          flex-shrink: 1; /* Allow to shrink */
          flex-grow: 1; /* Allow to grow */
          min-width: 0; /* Prevent overflow */
          padding: 12px 18px; /* Restore original padding for full-width buttons */
        }

        /* Labels should take full width and stack above their inputs */
        .form-group label {
          width: 100%; /* Make label take full width */
          margin-bottom: 4px; /* Maintain spacing below label */
          text-align: left; /* Align label text to left for readability */
        }
      }
    </style>
  </head>
  <body>
    <div class="container">
      <div style="position: relative; text-align: center">
        <h1>æ™ºèƒ½ç®¡ç†é¢æ¿</h1>
        <button
          onclick="toggleTheme()"
          class="theme-toggle-btn"
          title="åˆ‡æ¢æ·±è‰²æ¨¡å¼"
        >
          ğŸŒ“
        </button>
      </div>

      <!-- ç»Ÿè®¡ä¿¡æ¯å±•ç¤ºåŒº -->
      <div id="stats-container" class="section-box" style="display: none; padding: 10px;">
        <div style="display: flex; justify-content: center; text-align: center; gap: 30px;">
          <div>
            <div id="total-tasks-count" style="font-size: 2em; font-weight: bold; color: var(--accent);">0</div>
            <div style="font-size: 0.9em;">æ€»ä»»åŠ¡æ•°</div>
          </div>
          <div>
            <div id="successful-tasks-count" style="font-size: 2em; font-weight: bold; color: var(--success);">0</div>
            <div style="font-size: 0.9em;">æˆåŠŸä»»åŠ¡</div>
          </div>
          <div>
            <div id="failed-tasks-count" style="font-size: 2em; font-weight: bold; color: var(--error);">0</div>
            <div style="font-size: 0.9em;">å¤±è´¥ä»»åŠ¡</div>
          </div>
        </div>
      </div>

      <!-- Tabs åŒºåŸŸ -->
      <div class="tabs">
        <button
          class="tab-button active"
          onclick="switchTab('inspiration-management')"
        >
          çŸ¥ä¹
        </button>
        <button class="tab-button" onclick="switchTab('news-management')">
          çƒ­ç‚¹
        </button>
        <button class="tab-button" onclick="switchTab('publish-management')">
          å¤´æ¡
        </button>
        <button class="tab-button" onclick="switchTab('user-management')">
          ç”¨æˆ·
        </button>
      </div>

      <!-- çµæ„Ÿç®¡ç† Tab (çŸ¥ä¹) -->
      <div id="inspiration-management" class="tab-content active">
        <!-- æ–°å¢ï¼šè‡ªå®šä¹‰å‘å¸ƒæ¨¡å— -->
        <div class="section-box highlighted">
          <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 12px;">
            <h2 style="margin: 0; border: none; display: flex; align-items: center; gap: 8px;">
              âœ¨ æ–‡æ€æ³‰æ¶Œ
            </h2>
          </div>
          <p style="margin-top: 0; margin-bottom: 12px;">è¾“å…¥ä»»ä½•ä¸»é¢˜ã€å¤§çº²æˆ–å†…å®¹ï¼ŒAIè‡ªåŠ¨å†™æ–‡ç« å¹¶å¤´æ¡ã€‚</p>
          <div class="input-with-clear" style="margin-bottom: 12px;">
            <textarea
              id="custom-inspiration-text"
              placeholder="ä¾‹å¦‚ï¼šå†™ä¸€ç¯‡å…³äºâ€œAIåœ¨é‡åŒ–äº¤æ˜“ä¸­çš„åº”ç”¨â€çš„æ–‡ç« ï¼Œä¾§é‡äºé£é™©æ§åˆ¶ã€‚"
            ></textarea>
            <button
              type="button"
              class="input-clear-btn"
              onclick="clearCustomInspirationText()"
              title="æ¸…é™¤å†…å®¹"
            >
              Ã—
            </button>
          </div>
          <details style="margin-bottom: 12px;">
            <summary style="cursor: pointer; color: var(--text-sub); font-size: 0.9em; margin-bottom: 8px;">å‘å¸ƒé€‰é¡¹</summary>
            <div class="form-group" style="margin-top: 8px;">
              <label
                for="custom-inspiration-room-select"
                style="white-space: nowrap; align-self: center; font-weight: 500; min-width: 60px;"
                >å‘å¸ƒåˆ°:</label
              >
              <select id="custom-inspiration-room-select" style="flex: 1;"></select>
            </div>
          </details>
          <div class="form-group">
            <button
              id="submit-custom-inspiration-btn"
              onclick="submitCustomInspiration()"
              class="submit-button"
              style="flex: 1;"
            >
              âœï¸ ç”Ÿæˆå¹¶å‘å¸ƒ
            </button>
          </div>
          <div
            id="custom-inspiration-status"
            class="status-display"
            style="display: none; margin-top: 10px;"
          ></div>
        </div>

        <!-- çŸ¥ä¹çµæ„Ÿæ¨¡å— -->
        <div class="section-box">
          <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 12px;">
            <h2 style="margin: 0; border: none; display: flex; align-items: center; gap: 8px;">
              ğŸ’¡ çŸ¥ä¹çµæ„Ÿ
              <span id="inspiration-count" style="font-size: 0.8em; background: var(--accent); color: white; padding: 2px 8px; border-radius: 10px;"></span>
            </h2>
            <button onclick="fetchInspirations()" class="refresh-button" style="padding: 4px 10px; font-size: 0.85em;">
              ğŸ”„
            </button>
          </div>
          <div class="form-group" style="margin-bottom: 12px;">
            <div class="input-with-clear" style="flex: 1">
              <input
                type="text"
                id="inspiration-topic-input"
                placeholder="è¾“å…¥å…³é”®è¯ç­›é€‰"
              />
              <button
                type="button"
                class="input-clear-btn"
                onclick="clearInspirationInput()"
                title="æ¸…é™¤è¾“å…¥"
              >
                Ã—
              </button>
            </div>
            <button onclick="fetchInspirations()" style="padding: 8px 12px;">
              ç­›é€‰
            </button>
          </div>
          <details>
            <summary style="cursor: pointer; color: var(--text-sub); font-size: 0.9em; margin-bottom: 10px;">é«˜çº§é€‰é¡¹</summary>
            <div class="form-group" style="margin-top: 8px;">
              <label
                for="fetched-inspiration-room-select"
                style="white-space: nowrap; align-self: center; font-weight: 500; min-width: 60px;"
                >å‘å¸ƒåˆ°:</label
              >
              <select id="fetched-inspiration-room-select" style="flex: 1;"></select>
            </div>
          </details>
          <div
            id="inspiration-status"
            class="status-display"
            style="display: none; margin-top: 10px;"
          ></div>
          <div id="inspiration-topics-container" class="inspiration-grid">
            <div
              class="inspiration-card"
              style="
                justify-content: center;
                align-items: center;
                min-height: 120px;
              "
            >
              <span style="color: var(--text-sub); font-style: italic"
                >åŠ è½½ä¸­...</span
              >
            </div>
          </div>
        </div>
      </div>

      <!-- æ–°é—»ç®¡ç† Tab (çƒ­ç‚¹) -->
      <div id="news-management" class="tab-content">
        <div class="section-box">
          <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 12px;">
            <h2 style="margin: 0; border: none; display: flex; align-items: center; gap: 8px;">
              ğŸ“° å…¨ç½‘æ–°é—»
              <span id="news-count" style="font-size: 0.8em; background: var(--accent); color: white; padding: 2px 8px; border-radius: 10px;"></span>
            </h2>
            <button onclick="fetchNews()" class="refresh-button" style="padding: 4px 10px; font-size: 0.85em;">
              ğŸ”„
            </button>
          </div>
          <div class="form-group" style="margin-bottom: 12px;">
            <div class="input-with-clear" style="flex: 1">
              <input
                type="text"
                id="news-topic-input"
                placeholder="è¾“å…¥å…³é”®è¯ç­›é€‰æ–°é—»"
              />
              <button
                type="button"
                class="input-clear-btn"
                onclick="clearNewsInput()"
                title="æ¸…é™¤è¾“å…¥"
                style="display: none;"
              >
                Ã—
              </button>
            </div>
            <button onclick="searchNewsTopics()" style="padding: 8px 12px;">
              ç­›é€‰
            </button>
          </div>
          <details>
            <summary style="cursor: pointer; color: var(--text-sub); font-size: 0.9em; margin-bottom: 10px;">é«˜çº§é€‰é¡¹</summary>
            <div class="form-group" style="margin-top: 8px;">
              <label
                for="news-room-select"
                style="white-space: nowrap; align-self: center; font-weight: 500; min-width: 60px;"
                >å‘å¸ƒåˆ°:</label
              >
              <select id="news-room-select" style="flex: 1;"></select>
            </div>
          </details>
          <div
            id="news-status"
            class="status-display"
            style="display: none; margin-top: 10px;"
          ></div>
          <div id="news-topics-container" class="inspiration-grid">
            <div
              class="inspiration-card"
              style="
                justify-content: center;
                align-items: center;
                min-height: 120px;
              "
            >
              <span style="color: var(--text-sub); font-style: italic"
                >åŠ è½½ä¸­...</span
              >
            </div>
          </div>
        </div>
      </div>

      <!-- å‘å¸ƒç®¡ç† Tab (å¤´æ¡) -->
      <div id="publish-management" class="tab-content">
        <!-- æœ€æ–°å‘å¸ƒç»“æœ -->
        <div
          id="latest-result-container"
          class="section-box latest-result"
          style="display: none"
        >
          <div
            style="
              display: flex;
              justify-content: space-between;
              align-items: center;
              margin-bottom: 10px;
            "
          >
            <h2 style="margin: 0; border: none; padding: 0">æœ€æ–°å‘å¸ƒç»“æœ</h2>
            <span
              id="latest-result-time"
              style="font-size: 0.85em; color: var(--text-sub)"
            ></span>
          </div>
          <div id="latest-result-content"></div>
        </div>

        <!-- ä¿®æ­£ï¼šå°†åŸæœ¬é”™è¯¯æ”¾ç½®çš„ </div> ç§»åˆ°æ­¤å¤„ï¼Œä»¥åŒ…å«æ‰€æœ‰â€œå‘å¸ƒç®¡ç†â€çš„å†…å®¹ -->
        <div class="section-container">
          <!-- å†å²å‘å¸ƒç»“æœ -->
          <div class="section-box highlighted">
            <div
              style="
                display: flex;
                justify-content: space-between;
                align-items: center;
                width: 100%;
              "
            >
              <h2>ğŸ“‹ å†å²å‘å¸ƒç»“æœ</h2>
              <button
                onclick="fetchPublishResults()"
                class="refresh-button"
                style="padding: 6px 10px; font-size: 0.8em"
              >
                ğŸ”„ åˆ·æ–°
              </button>
            </div>
            <ul id="publish-results-list" style="max-height: 300px">
              <li>åŠ è½½ä¸­...</li>
            </ul>
          </div>
          <!-- ä»»åŠ¡é˜Ÿåˆ— -->
          <div class="section-box">
            <h2>ğŸ•’ ä»»åŠ¡é˜Ÿåˆ—</h2>
            <p>
              å½“å‰é˜Ÿåˆ—é•¿åº¦:
              <span
                id="publish-queue-length"
                style="font-weight: 600; color: var(--accent)"
                >0</span
              >
            </p>
            <div class="form-group" style="gap: 8px; margin-bottom: 8px">
              <button onclick="fetchPublishQueueStatus()">ğŸ”„ åˆ·æ–°é˜Ÿåˆ—</button>
              <button onclick="clearPublishQueue()" class="delete-button">
                ğŸ—‘ï¸ æ¸…ç©ºé˜Ÿåˆ—
              </button>
              <button onclick="processPublishQueue()">â–¶ï¸ å¤„ç†é˜Ÿåˆ—</button>
            </div>
            <h3>å¾…å¤„ç†ä»»åŠ¡</h3>
            <ul id="publish-pending-tasks-list">
              <li>é˜Ÿåˆ—ä¸ºç©º</li>
            </ul>
          </div>
          <!-- ä»»åŠ¡çŠ¶æ€æŸ¥è¯¢ -->
          <div class="section-box">
            <h2>ğŸ” ä»»åŠ¡çŠ¶æ€æŸ¥è¯¢</h2>
            <div class="form-group">
              <input
                type="text"
                id="publish-check-task-id"
                placeholder="è¾“å…¥ä»»åŠ¡ID"
              />
              <button onclick="checkPublishTaskStatus()">æŸ¥è¯¢çŠ¶æ€</button>
            </div>
            <h3>ä»»åŠ¡è¯¦æƒ…:</h3>
            <pre id="publish-task-status-display">æ— ä»»åŠ¡ä¿¡æ¯</pre>
          </div>
          <!-- æœåŠ¡ç»Ÿè®¡ -->
          <div class="section-box">
            <h2>ğŸ“Š æœåŠ¡ç»Ÿè®¡</h2>
            <button onclick="fetchPublishStats()">åˆ·æ–°ç»Ÿè®¡</button>
            <pre id="publish-stats-display">åŠ è½½ä¸­...</pre>
          </div>
        </div>
      </div> <!-- <--- è¿™æ˜¯ "publish-management" æ­£ç¡®çš„ç»“æŸæ ‡ç­¾ä½ç½® -->

      <!-- ç”¨æˆ·ç®¡ç† Tab -->
      <div id="user-management" class="tab-content">
        <div class="section-box">
          <h2>å·²æ¿€æ´»çš„æˆ¿é—´</h2>
          <ul
            id="activated-room-list"
            style="
              display: flex;
              flex-wrap: wrap;
              gap: 10px;
              padding: 0;
              border: none;
              background: none;
            "
          >
            <li
              class="no-rooms"
              style="
                background: none;
                border: 2px dashed var(--text-sub);
                color: var(--text-sub);
                cursor: default;
                font-style: italic;
              "
            >
              æ­£åœ¨åŠ è½½æˆ¿é—´...
            </li>
          </ul>
        </div>
        <div class="section-box">
          <h2>ç™½åå•ç®¡ç†</h2>
          <p>
            ğŸ’¡ ä½¿ç”¨è¯´æ˜ï¼š <br />â€¢ æ¯ä¸ªæˆ¿é—´å¯ä»¥å•ç‹¬è®¾ç½®ç™½åå• <br />â€¢
            åªæœ‰ç™½åå•ä¸­çš„ç”¨æˆ·æ‰èƒ½è®¿é—®æˆ¿é—´åŠŸèƒ½ <br />â€¢
            éœ€è¦ç®¡ç†å‘˜å¯†é’¥æ‰èƒ½ä¿®æ”¹ç™½åå•
          </p>
          <div class="controls">
            <input
              type="text"
              id="room-name-input"
              placeholder="è¾“å…¥æˆ–é€‰æ‹©æˆ¿é—´å (e.g., test)"
            />
            <button id="load-users-btn">åŠ è½½</button>
          </div>
          <div id="status-message" class="status-display"></div>
          <ul id="user-list">
            <li style="justify-content: center; color: #7f8c8d">
              è¯·é€‰æ‹©æˆ–è¾“å…¥æˆ¿é—´ååŠ è½½ç™½åå•
            </li>
          </ul>
          <div class="form-group">
            <input
              type="text"
              id="new-user-input"
              placeholder="è¾“å…¥è¦æ·»åŠ çš„ç”¨æˆ·å"
            />
            <button id="add-user-btn">æ·»åŠ </button>
          </div>
        </div>
      </div>

    <script>
      // =================================================================
      //  Initialization & Config
      // =================================================================
      const potentialRoomsToCheck = window.MANAGEMENT_ROOMS_LIST || [
        'test',
        'future',
        'admin',
        'kerry',
      ]
      const envConfig = window.ENV_CONFIG || {}
      const apiDomain = window.ENV_CONFIG.apiDomain
      const urlParams = new URLSearchParams(window.location.search)
      const adminSecret = urlParams.get('secret')
      const initialRoom = urlParams.get('room')

      // Store fetched data
      let allInspirationsData = []
      let allNewsData = []

      // =================================================================
      //  DOM Element Declarations
      // =================================================================
      // User Management
      const roomNameInput = document.getElementById('room-name-input')
      const userList = document.getElementById('user-list')
      const newUserInput = document.getElementById('new-user-input')
      const addUserBtn = document.getElementById('add-user-btn')
      const loadUsersBtn = document.getElementById('load-users-btn')
      const statusMessage = document.getElementById('status-message')
      const activatedRoomList = document.getElementById('activated-room-list')

      // Inspiration Management
      const customInspirationText = document.getElementById(
        'custom-inspiration-text',
      )
      const customInspirationRoomSelect = document.getElementById(
        'custom-inspiration-room-select',
      )
      const customInspirationStatus = document.getElementById(
        'custom-inspiration-status',
      )
      const inspirationTopicInput = document.getElementById(
        'inspiration-topic-input',
      )
      const fetchedInspirationRoomSelect = document.getElementById(
        'fetched-inspiration-room-select',
      )
      const inspirationTopicsContainer = document.getElementById(
        'inspiration-topics-container',
      )
      const inspirationStatus = document.getElementById('inspiration-status')

      // News Management
      const newsTopicInput = document.getElementById('news-topic-input')
      const newsRoomSelect = document.getElementById('news-room-select')
      const newsTopicsContainer = document.getElementById(
        'news-topics-container',
      )
      const newsStatus = document.getElementById('news-status')

      // Publish Management
      const publishQueueLength = document.getElementById('publish-queue-length')
      const publishPendingTasksList = document.getElementById(
        'publish-pending-tasks-list',
      )
      const publishCheckTaskId = document.getElementById(
        'publish-check-task-id',
      )
      const publishTaskStatusDisplay = document.getElementById(
        'publish-task-status-display',
      )
      const publishStatsDisplay = document.getElementById(
        'publish-stats-display',
      )
      const publishResultsList = document.getElementById('publish-results-list')
      const latestResultContainer = document.getElementById(
        'latest-result-container',
      )
      const latestResultContent = document.getElementById(
        'latest-result-content',
      )
      const latestResultTime = document.getElementById('latest-result-time')
      // Stats Container
      const statsContainer = document.getElementById('stats-container');

      // =================================================================
      //  Core UI & Helpers
      // =================================================================
      function initTheme() {
        const saved = localStorage.getItem('theme')
        const prefersDark = window.matchMedia(
          '(prefers-color-scheme: dark)',
        ).matches
        const theme = saved ? saved : prefersDark ? 'dark' : 'light'
        document.documentElement.setAttribute('data-theme', theme)
      }

      function toggleTheme() {
        const current = document.documentElement.getAttribute('data-theme')
        const next = current === 'dark' ? 'light' : 'dark'
        document.documentElement.setAttribute('data-theme', next)
        localStorage.setItem('theme', next)
      }

      function updateStatus(element, msg, type = 'info', show = true) {
        element.textContent = msg
        element.className = `status-display status-${type}`
        element.style.display = show ? 'block' : 'none'
      }

      function populateRoomSelects() {
        const selects = [
          customInspirationRoomSelect,
          fetchedInspirationRoomSelect,
          newsRoomSelect,
        ]
        selects.forEach(select => {
          if (!select) return
          select.innerHTML = ''
          potentialRoomsToCheck.forEach(room => {
            const option = document.createElement('option')
            option.value = room
            option.textContent = room
            select.appendChild(option)
          })
        })
      }

      function switchTab(tabId) {
        document
          .querySelectorAll('.tab-content')
          .forEach(c => c.classList.remove('active'))
        document
          .querySelectorAll('.tab-button')
          .forEach(b => b.classList.remove('active'))
        document.getElementById(tabId).classList.add('active')
        document
          .querySelector(`.tab-button[onclick="switchTab('${tabId}')"]`)
          .classList.add('active')

        switch (tabId) {
          case 'inspiration-management':
            if (allInspirationsData.length === 0) fetchInspirations()
            break
          case 'news-management':
            if (allNewsData.length === 0) fetchNews()
            break
          case 'publish-management':
            fetchPublishQueueStatus()
            fetchPublishStats()
            fetchPublishResults()
            break
          case 'user-management':
            fetchActivatedRooms()
            if (initialRoom) {
              roomNameInput.value = initialRoom
              fetchUsers()
            }
            break
        }
      }

      // =================================================================
      //  Unified Article Generation & Submission
      // =================================================================
      async function generateArticleFromInspiration(
        inspirationItem,
        roomName,
        buttonElement,
        statusUpdater,
      ) {
        if (!inspirationItem || !roomName) {
          statusUpdater('æœªèƒ½æ‰¾åˆ°è¯é¢˜çš„è¯¦ç»†ä¿¡æ¯æˆ–ç›®æ ‡æˆ¿é—´', 'error', true)
          return
        }

        const originalText = buttonElement.innerHTML
        buttonElement.disabled = true
        buttonElement.innerHTML = 'ç”Ÿæˆä¸­...'
        statusUpdater(`æ­£åœ¨ä¸ºæˆ¿é—´ [${roomName}] æäº¤ç”Ÿæˆä»»åŠ¡...`, 'info', true)

        try {
          const domain = `https://${apiDomain || 'api.yuangs.cc'}`
          const res = await fetch(`${domain}/api/inspirations/generate`, {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify({
              inspiration: inspirationItem,
              roomName: roomName,
              secret: adminSecret,
            }),
          })

          const data = await res.json()
          if (res.ok && data.success) {
            statusUpdater(
              `âœ… ä»»åŠ¡å·²æˆåŠŸæäº¤ (ID: ${data.taskId.substring(0, 8)}...)ï¼Œè¯·ç¨ååœ¨â€œå‘å¸ƒç®¡ç†â€é¡µæŸ¥çœ‹ã€‚`,
              'success',
              true,
            )
            fetchPublishQueueStatus() // Auto-refresh queue
          } else {
            throw new Error(data.message || 'æœªçŸ¥é”™è¯¯')
          }
        } catch (e) {
          statusUpdater(`âŒ ç”Ÿæˆæ–‡ç« å¤±è´¥: ${e.message}`, 'error', true)
        } finally {
          buttonElement.disabled = false
          buttonElement.innerHTML = originalText
        }
      }

      function submitCustomInspiration() {
        const text = customInspirationText.value.trim()
        const room = customInspirationRoomSelect.value
        const button = document.getElementById('submit-custom-inspiration-btn')

        if (!text) {
          updateStatus(
            customInspirationStatus,
            'è¯·è¾“å…¥ä¸»é¢˜æˆ–å†…å®¹ï¼',
            'error',
            true,
          )
          return
        }

        const customInspiration = {
          title: text.substring(0, 50), // Use first 50 chars as title
          contentPrompt: text, // Full text is the prompt
          type: 'custom',
        }

        generateArticleFromInspiration(
          customInspiration,
          room,
          button,
          (msg, type, show) =>
            updateStatus(customInspirationStatus, msg, type, show),
        )
      }

      function clearCustomInspirationText() {
        const textarea = document.getElementById('custom-inspiration-text')
        const clearBtn = document.querySelector('.input-clear-btn')
        if (textarea) {
          textarea.value = ''
          textarea.focus()
          if (clearBtn) clearBtn.style.display = 'none'
          updateStatus(customInspirationStatus, 'å†…å®¹å·²æ¸…é™¤', 'success', true)
          setTimeout(() => {
            updateStatus(customInspirationStatus, '', 'success', false)
          }, 2000)
        }
      }

      // ç›‘å¬è¾“å…¥æ¡†å†…å®¹å˜åŒ–ï¼Œæ§åˆ¶æ¸…é™¤æŒ‰é’®æ˜¾ç¤º
      document.addEventListener('DOMContentLoaded', function () {
        const textarea = document.getElementById('custom-inspiration-text')
        const clearBtn = document.querySelector('.input-clear-btn')

        if (textarea && clearBtn) {
          function updateClearButtonVisibility() {
            clearBtn.style.display = textarea.value.trim() ? 'flex' : 'none'
          }

          // åˆå§‹çŠ¶æ€æ£€æŸ¥
          updateClearButtonVisibility()

          // ç›‘å¬è¾“å…¥äº‹ä»¶
          textarea.addEventListener('input', updateClearButtonVisibility)

          // ç›‘å¬ç²˜è´´äº‹ä»¶
          textarea.addEventListener('paste', function () {
            setTimeout(updateClearButtonVisibility, 0)
          })
        }
      })

      // =================================================================
      //  Inspiration & News Fetching and Rendering
      // =================================================================
      async function fetchInspirations() {
        updateStatus(inspirationStatus, 'æ­£åœ¨è·å–çŸ¥ä¹çµæ„Ÿ...', 'info', true)
        inspirationTopicsContainer.innerHTML =
          '<div class="inspiration-card" style="justify-content: center; align-items: center;"><span style="color: var(--text-sub);">åŠ è½½ä¸­...</span></div>'
        try {
          const domain = `https://${apiDomain || 'api.yuangs.cc'}`
          // ä¸“é—¨è·å–çŸ¥ä¹ç›¸å…³çš„å†…å®¹ï¼Œé¿å…ä¸æ–°é—»é‡å¤
          const res = await fetch(
            `${domain}/api/inspirations?secret=${adminSecret}&source=zhihu`,
          )
          if (!res.ok) throw new Error(await res.text())
          const data = await res.json()
          // è¿‡æ»¤å‡ºçŸ¥ä¹ç›¸å…³çš„çµæ„Ÿ
          allInspirationsData =
            data.data.filter(
              item => item.source && item.source.includes('çŸ¥ä¹'),
            ) || []

          // æ›´æ–°è®¡æ•°æ˜¾ç¤º
          const countElement = document.getElementById('inspiration-count');
          if (countElement) {
            countElement.textContent = allInspirationsData.length;
          }

          // è·å–å…³é”®è¯å¹¶ç­›é€‰
          const keyword = inspirationTopicInput.value.trim().toLowerCase()
          if (keyword) {
            const filtered = allInspirationsData.filter(t =>
              t.title.toLowerCase().includes(keyword),
            )
            renderInspirations(filtered)
            updateStatus(
              inspirationStatus,
              `æˆåŠŸè·å– ${allInspirationsData.length} ä¸ªçŸ¥ä¹çµæ„Ÿï¼Œç­›é€‰å‡º ${filtered.length} ä¸ª`,
              'success',
              false,
            )
          } else {
            renderInspirations(allInspirationsData)
            updateStatus(
              inspirationStatus,
              `æˆåŠŸè·å– ${allInspirationsData.length} ä¸ªçŸ¥ä¹çµæ„Ÿ`,
              'success',
              false,
            )
          }
        } catch (e) {
          updateStatus(
            inspirationStatus,
            `è·å–çŸ¥ä¹çµæ„Ÿå¤±è´¥: ${e.message}`,
            'error',
            true,
          )
        }
      }

      async function fetchNews() {
        updateStatus(newsStatus, 'æ­£åœ¨è·å–å…¨ç½‘æ–°é—»...', 'info', true)
        newsTopicsContainer.innerHTML =
          '<div class="inspiration-card" style="justify-content: center; align-items: center;"><span style="color: var(--text-sub);">åŠ è½½ä¸­...</span></div>'
        try {
          const domain = `https://${apiDomain || 'api.yuangs.cc'}`
          // ä¸“é—¨è·å–æ–°é—»å†…å®¹ï¼ˆæŠ–éŸ³ã€å¾®åšã€è™æ‰‘ç­‰ï¼‰ï¼Œæ’é™¤çŸ¥ä¹å†…å®¹
          const res = await fetch(
            `${domain}/api/inspirations?secret=${adminSecret}&type=news`,
          )
          if (!res.ok) throw new Error(await res.text())
          const data = await res.json()
          allNewsData =
            data.data.filter(
              item => item.source && !item.source.includes('çŸ¥ä¹'),
            ) || []
          
          // æ›´æ–°è®¡æ•°æ˜¾ç¤º
          const countElement = document.getElementById('news-count');
          if (countElement) {
            countElement.textContent = allNewsData.length;
          }
          
          renderNews(allNewsData)
          updateStatus(
            newsStatus,
            `æˆåŠŸè·å– ${allNewsData.length} ä¸ªå…¨ç½‘æ–°é—»`,
            'success',
            false,
          )
        } catch (e) {
          updateStatus(
            newsStatus,
            `è·å–å…¨ç½‘æ–°é—»å¤±è´¥: ${e.message}`,
            'error',
            true,
          )
        }
      }

      function clearInspirationInput() {
        inspirationTopicInput.value = ''
        renderInspirations(allInspirationsData)
        updateStatus(inspirationStatus, 'å·²æ¸…é™¤ç­›é€‰æ¡ä»¶', 'success', true)
        inspirationTopicInput.focus()

        // éšè—æ¸…é™¤æŒ‰é’®
        const clearBtn =
          inspirationTopicInput.parentElement.querySelector('.input-clear-btn')
        if (clearBtn) {
          clearBtn.style.display = 'none'
        }
      }

      function clearNewsInput() {
        newsTopicInput.value = ''
        renderNews(allNewsData)
        updateStatus(newsStatus, 'å·²æ¸…é™¤ç­›é€‰æ¡ä»¶', 'success', true)
        newsTopicInput.focus()

        // éšè—æ¸…é™¤æŒ‰é’®
        const clearBtn =
          newsTopicInput.parentElement.querySelector('.input-clear-btn')
        if (clearBtn) {
          clearBtn.style.display = 'none'
        }
      }

      function searchNewsTopics() {
        const keyword = newsTopicInput.value.trim().toLowerCase()
        const filtered = allNewsData.filter(t =>
          t.title.toLowerCase().includes(keyword),
        )
        renderNews(filtered)
        updateStatus(
          newsStatus,
          `ç­›é€‰å‡º ${filtered.length} ä¸ªæ–°é—»`,
          'info',
          true,
        )
      }

      function renderInspirations(topics) {
        renderCards(
          topics,
          inspirationTopicsContainer,
          fetchedInspirationRoomSelect,
          updateInspirationStatus,
        )
      }

      function renderNews(topics) {
        renderCards(
          topics,
          newsTopicsContainer,
          newsRoomSelect,
          updateNewsStatus,
        )
      }

      function updateInspirationStatus(msg, type, show) {
        updateStatus(inspirationStatus, msg, type, show)
      }
      function updateNewsStatus(msg, type, show) {
        updateStatus(newsStatus, msg, type, show)
      }

      function renderCards(items, container, roomSelectElement, statusUpdater) {
        container.innerHTML = ''
        if (!items || items.length === 0) {
          container.innerHTML =
            '<div class="inspiration-card" style="text-align: center; padding: 30px;"><p>æš‚æ— æ•°æ®</p></div>'
          return
        }
        items.forEach((item, index) => {
          const card = document.createElement('div')
          card.className = 'inspiration-card'

          // åˆ›å»ºå¡ç‰‡å¤´éƒ¨ï¼ˆæ ‡é¢˜å’Œæ¥æºï¼‰
          const header = document.createElement('div')
          header.className = 'inspiration-card-header'
          
          const title = document.createElement('h3')
          title.className = 'inspiration-card-title'
          title.textContent = item.title

          const source = document.createElement('div')
          source.className = 'inspiration-card-source'
          source.textContent = item.source || 'æœªçŸ¥æ¥æº'

          header.appendChild(title)
          header.appendChild(source)

          // åˆ›å»ºæè¿°éƒ¨åˆ†
          const description = document.createElement('div')
          description.className = 'inspiration-card-description'
          const descriptionContent = item.excerpt || item.description || ''
          description.textContent = descriptionContent

          // åˆ›å»ºæ“ä½œæŒ‰é’®åŒºåŸŸ
          const actions = document.createElement('div')
          actions.className = 'inspiration-card-actions'

          const generateBtn = document.createElement('button')
          generateBtn.innerHTML = 'âœï¸ ä¸€é”®æˆæ–‡'
          generateBtn.className = 'submit-button'
          generateBtn.onclick = e => {
            e.stopPropagation()
            const selectedRoom = roomSelectElement.value
            generateArticleFromInspiration(
              item,
              selectedRoom,
              generateBtn,
              statusUpdater,
            )
          }

          const viewBtn = document.createElement('button')
          viewBtn.textContent = 'åŸæ–‡'
          viewBtn.style.background = 'var(--bg)'
          viewBtn.style.color = 'var(--text)'
          viewBtn.style.border = '1px solid var(--border)'
          viewBtn.onclick = e => {
            e.stopPropagation()
            if (item.url) {
              // å°è¯•ä½¿ç”¨åº”ç”¨åè®®æ‰“å¼€ï¼Œå¦‚æœå¤±è´¥åˆ™åœ¨æ–°æ ‡ç­¾é¡µæ‰“å¼€
              const link = document.createElement('a');
              link.href = item.url;
              link.target = '_blank';
              link.rel = 'noopener noreferrer';
              link.click();
            }
          }

          actions.appendChild(generateBtn)
          if (item.url) actions.appendChild(viewBtn)

          // ç»„è£…å¡ç‰‡
          card.appendChild(header)
          if (descriptionContent) card.appendChild(description)
          card.appendChild(actions)
          container.appendChild(card)
        })
      }

      // =================================================================
      //  Publish Management Functions
      // =================================================================
      async function fetchPublishQueueStatus() {
        try {
          const domain = `https://${apiDomain || 'api.yuangs.cc'}`
          console.log(
            'Fetching queue status from:',
            `${domain}/api/toutiao/queue?secret=${adminSecret}`,
          )
          const res = await fetch(
            `${domain}/api/toutiao/queue?secret=${adminSecret}`,
          )
          if (!res.ok) {
            const errorText = await res.text()
            console.error('Failed to fetch queue status:', errorText)
            throw new Error(errorText)
          }
          const data = await res.json()
          console.log('Queue status data:', data)
          publishQueueLength.textContent = data.length || 0
          publishPendingTasksList.innerHTML = ''
          if (data.tasks && data.tasks.length > 0) {
            data.tasks.forEach(task => {
              const li = document.createElement('li')
              const taskText =
                (
                  task.text ||
                  task.data?.text ||
                  task.content ||
                  'æ— å†…å®¹'
                ).substring(0, 50) + '...'
              const status = task.status || 'pending'
              const statusClass =
                status === 'pending'
                  ? 'status-tag pending'
                  : status === 'processing'
                    ? 'status-tag processing'
                    : status === 'completed'
                      ? 'status-tag success'
                      : status === 'failed'
                        ? 'status-tag error'
                        : 'status-tag'

              li.innerHTML = `<strong>ID:</strong> ${task.id.substring(0, 8)}... <strong>å†…å®¹:</strong> ${taskText} <span class="${statusClass}">${status}</span>`
              publishPendingTasksList.appendChild(li)
            })
          } else {
            publishPendingTasksList.innerHTML = '<li>é˜Ÿåˆ—ä¸ºç©º</li>'
          }
        } catch (e) {
          console.error('Error fetching queue status:', e)
          publishPendingTasksList.innerHTML = `<li style="color: var(--error);">åŠ è½½å¤±è´¥: ${e.message}</li>`
        }
      }

      async function clearPublishQueue() {
        if (!confirm('ç¡®å®šè¦æ¸…ç©ºæ‰€æœ‰å¾…å¤„ç†çš„å‘å¸ƒä»»åŠ¡å—ï¼Ÿ')) return
        try {
          const domain = `https://${apiDomain || 'api.yuangs.cc'}`
          await fetch(`${domain}/api/toutiao/queue?secret=${adminSecret}`, {
            method: 'DELETE',
          })
          fetchPublishQueueStatus()
        } catch (e) {
          alert(`æ¸…ç©ºå¤±è´¥: ${e.message}`)
        }
      }

      async function processPublishQueue() {
        if (!confirm('ç¡®å®šè¦ç«‹å³å¤„ç†é˜Ÿåˆ—ä¸­çš„æ‰€æœ‰ä»»åŠ¡å—ï¼Ÿ')) return
        try {
          const domain = `https://${apiDomain || 'api.yuangs.cc'}`
          const res = await fetch(
            `${domain}/api/toutiao/queue?secret=${adminSecret}`,
            {
              method: 'POST',
            },
          )
          if (!res.ok) throw new Error(await res.text())

          alert('é˜Ÿåˆ—å¤„ç†å·²å¯åŠ¨ï¼Œè¯·ç¨ååˆ·æ–°æŸ¥çœ‹ç»“æœ')
          setTimeout(() => {
            fetchPublishQueueStatus()
            fetchPublishResults()
            fetchPublishStats()
          }, 3000)
        } catch (e) {
          alert(`å¤„ç†å¤±è´¥: ${e.message}`)
        }
      }

      async function checkPublishTaskStatus() {
        const taskId = publishCheckTaskId.value.trim()
        if (!taskId) return
        try {
          const domain = `https://${apiDomain || 'api.yuangs.cc'}`
          const res = await fetch(
            `${domain}/api/toutiao/results?id=${taskId}&secret=${adminSecret}`,
          )
          const data = await res.json()
          publishTaskStatusDisplay.textContent = JSON.stringify(data, null, 2)
        } catch (e) {
          publishTaskStatusDisplay.textContent = `æŸ¥è¯¢å¤±è´¥: ${e.message}`
        }
      }

      async function fetchPublishStats() {
        try {
          const domain = `https://${apiDomain || 'api.yuangs.cc'}`
          const res = await fetch(
            `${domain}/api/toutiao/stats?secret=${adminSecret}`,
          )
          const data = await res.json()
          publishStatsDisplay.textContent = JSON.stringify(data, null, 2)
          
          // æ›´æ–°é¡¶éƒ¨ç»Ÿè®¡ä¿¡æ¯
          updateTopStats(data);
        } catch (e) {
          publishStatsDisplay.textContent = `åŠ è½½å¤±è´¥: ${e.message}`
        }
      }
      
      function updateTopStats(statsData) {
        // æ˜¾ç¤ºç»Ÿè®¡å®¹å™¨
        statsContainer.style.display = 'block';
        
        // è·å–ç»Ÿè®¡æ•°å­—å…ƒç´ 
        const totalTasksElement = document.getElementById('total-tasks-count');
        const successfulTasksElement = document.getElementById('successful-tasks-count');
        const failedTasksElement = document.getElementById('failed-tasks-count');
        
        // æ›´æ–°ç»Ÿè®¡æ•°å­—
        if (totalTasksElement) {
          totalTasksElement.textContent = statsData.totalTasks || 0;
        }
        if (successfulTasksElement) {
          successfulTasksElement.textContent = statsData.successfulTasks || 0;
        }
        if (failedTasksElement) {
          failedTasksElement.textContent = statsData.failedTasks || 0;
        }
      }

      async function fetchPublishResults() {
        publishResultsList.innerHTML = '<li>åŠ è½½ä¸­...</li>'
        try {
          const domain = `https://${apiDomain || 'api.yuangs.cc'}`
          console.log(
            'Fetching publish results from:',
            `${domain}/api/toutiao/results?secret=${adminSecret}`,
          )
          const res = await fetch(
            `${domain}/api/toutiao/results?secret=${adminSecret}`,
          )
          if (!res.ok) {
            const errorText = await res.text()
            console.error('Failed to fetch publish results:', errorText)
            throw new Error(errorText)
          }
          const data = await res.json()
          console.log('Publish results data:', data)
          publishResultsList.innerHTML = ''
          if (data && data.length > 0) {
            showLatestResult(data[0])
            data.forEach(result => {
              const li = document.createElement('li')
              const title = result.title || result.topic || 'æ— æ ‡é¢˜'
              const isSuccess =
                result.success ||
                (result.publishResult && result.publishResult.success) ||
                result.status === 'success'
              const status = isSuccess
                ? '<span class="status-tag success">æˆåŠŸ</span>'
                : '<span class="status-tag error">å¤±è´¥</span>'
              const completedAt =
                result.createdAt || result.completedAt
                  ? new Date(
                      result.createdAt || result.completedAt,
                    ).toLocaleString()
                  : 'N/A'
              
              // æ·»åŠ è·³è½¬é“¾æ¥
              const articleUrl = result.articleUrl || result.url || (result.publishResult && result.publishResult.articleUrl);
              const titleHtml = articleUrl 
                ? `<a href="${articleUrl}" target="_blank" style="color: var(--accent); text-decoration: none;">${title}</a>`
                : `<strong>${title}</strong>`;
              
              li.innerHTML = `${status} ${titleHtml} <small>(${completedAt})</small>`
              publishResultsList.appendChild(li)
            })
          } else {
            latestResultContainer.style.display = 'none'
            publishResultsList.innerHTML = '<li>æš‚æ— å†å²å‘å¸ƒç»“æœ</li>'
          }
        } catch (e) {
          console.error('Error fetching publish results:', e)
          latestResultContainer.style.display = 'none'
          publishResultsList.innerHTML = `<li style="color: var(--error);">åŠ è½½å¤±è´¥: ${e.message}</li>`
        }
      }

      function showLatestResult(result) {
        // å¦‚æœæ²¡æœ‰ç»“æœï¼Œåˆ™éšè—å®¹å™¨å¹¶è¿”å›
        if (!result) {
          latestResultContainer.style.display = 'none';
          return;
        }

        // ç¡®ä¿å®¹å™¨å¯è§
        latestResultContainer.style.display = 'block';

        // åˆ¤æ–­ä»»åŠ¡æ˜¯å¦æˆåŠŸï¼Œä¼˜å…ˆä½¿ç”¨ result.status
        const isSuccess = result.status === 'success';

        // æ ¹æ®æˆåŠŸæˆ–å¤±è´¥çŠ¶æ€æ›´æ–°å®¹å™¨çš„ç±»ï¼Œä»è€Œæ”¹å˜æ ·å¼ï¼ˆä¾‹å¦‚è¾¹æ¡†é¢œè‰²ï¼‰
        latestResultContainer.className = isSuccess
          ? 'section-box latest-result' // æˆåŠŸæ—¶ä¿ç•™åŸæœ‰æ ·å¼
          : 'section-box latest-result error'; // å¤±è´¥æ—¶æ·»åŠ  error æ ·å¼

        // æ˜¾ç¤ºæ—¶é—´ï¼Œä½¿ç”¨ createdAt å­—æ®µ
        latestResultTime.textContent = result.createdAt
          ? new Date(result.createdAt).toLocaleString()
          : 'N/A';

        // è·å–æ ‡é¢˜ï¼Œé˜²æ­¢ä¸ºç©º
        const title = result.title || result.topic || 'æ— æ ‡é¢˜';

        // æ ¹æ®æˆåŠŸæˆ–å¤±è´¥çŠ¶æ€ç”Ÿæˆå¯¹åº”çš„çŠ¶æ€æ ‡ç­¾HTML
        const statusTagHtml = isSuccess
          ? '<span class="status-tag success">å‘å¸ƒæˆåŠŸ</span>'
          : '<span class="status-tag error">å‘å¸ƒå¤±è´¥</span>';

        // è·å–é”™è¯¯ä¿¡æ¯ï¼Œä¼˜å…ˆä½¿ç”¨é¡¶å±‚ error å­—æ®µï¼Œå…¶æ¬¡æ˜¯ errorDetails.message
        const errorMsgContent = result.error || result.errorDetails?.message;
        const errorMsgHtml = errorMsgContent
          ? `<div style="color: var(--error); margin-top: 4px;">é”™è¯¯: ${errorMsgContent}</div>`
          : '';

        // æ·»åŠ è·³è½¬é“¾æ¥
        const articleUrl = result.articleUrl || result.url || (result.publishResult && result.publishResult.articleUrl);
        const titleHtml = articleUrl 
          ? `<a href="${articleUrl}" target="_blank" style="color: var(--accent); text-decoration: none; font-weight: bold; font-size: 1.1em;">${title}</a>`
          : `<div style="font-weight: bold; font-size: 1.1em;">${title}</div>`;

        // å¡«å……å†…å®¹åŒºåŸŸï¼Œç¡®ä¿æ–‡æœ¬æ¢è¡Œ
        latestResultContent.innerHTML = `
            ${titleHtml}
            <div><strong>çŠ¶æ€:</strong> ${statusTagHtml}</div>
            ${errorMsgHtml}
        `;
      }
      // =================================================================
      //  User Management Functions
      // =================================================================
      async function fetchActivatedRooms() {
        activatedRoomList.innerHTML = '<li class="no-rooms">æ­£åœ¨åŠ è½½...</li>'
        const activeRooms = []
        const domain = `https://${apiDomain || 'api.yuangs.cc'}`
        const fetches = potentialRoomsToCheck.map(r =>
          fetch(`${domain}/api/room/status?roomName=${encodeURIComponent(r)}`)
            .then(res => res.json())
            .then(d => (d.active ? r : null))
            .catch(e => {
              console.error(`æˆ¿é—´ ${r} æ£€æŸ¥å¤±è´¥:`, e)
              return null
            }),
        )
        const results = await Promise.all(fetches)
        results.forEach(r => r && activeRooms.push(r))

        activatedRoomList.innerHTML = ''
        if (!activeRooms.length) {
          activatedRoomList.innerHTML =
            '<li class="no-rooms">æš‚æ— å·²æ¿€æ´»çš„æˆ¿é—´</li>'
        } else {
          activeRooms.forEach(r => {
            const li = document.createElement('li')
            li.textContent = r
            li.style.cursor = 'pointer'
            li.onclick = () => {
              roomNameInput.value = r
              fetchUsers()
            }
            activatedRoomList.appendChild(li)
          })
        }
      }

      async function fetchUsers() {
        const room = roomNameInput.value.trim()
        if (!room) {
          updateStatus(statusMessage, 'è¯·è¾“å…¥æˆ¿é—´åï¼', 'error')
          return
        }
        updateStatus(statusMessage, `æ­£åœ¨åŠ è½½æˆ¿é—´ "${room}" çš„ç™½åå•â€¦`, 'info')
        try {
          const domain = `https://${apiDomain || 'api.yuangs.cc'}`
          console.log(
            'è·å–ç”¨æˆ·ç™½åå•:',
            `${domain}/api/users/list?roomName=${encodeURIComponent(room)}&secret=${adminSecret}`,
          )

          const res = await fetch(
            `${domain}/api/users/list?roomName=${encodeURIComponent(room)}&secret=${adminSecret}`,
          )
          if (!res.ok) {
            const errorText = await res.text()
            console.error('è·å–ç”¨æˆ·åˆ—è¡¨å¤±è´¥:', errorText)
            throw new Error(errorText)
          }

          const data = await res.json()
          console.log('ç”¨æˆ·åˆ—è¡¨æ•°æ®:', data)
          userList.innerHTML = ''

          if (!data.active) {
            userList.innerHTML = '<li>æ­¤æˆ¿é—´å°šæœªæ¿€æ´»ç™½åå•åŠŸèƒ½</li>'
          } else if (!data.users || !data.users.length) {
            userList.innerHTML = '<li>æ­¤æˆ¿é—´ç™½åå•å·²æ¿€æ´»ä½†ä¸ºç©º</li>'
          } else {
            data.users.forEach(u => {
              const li = document.createElement('li')
              li.style.display = 'flex'
              li.style.justifyContent = 'space-between'
              li.style.alignItems = 'center'
              li.style.padding = '8px'

              const span = document.createElement('span')
              span.textContent = u
              span.style.marginRight = '10px'

              const btn = document.createElement('button')
              btn.textContent = 'ç§»é™¤'
              btn.className = 'delete-button'
              btn.style.fontSize = '0.8em'
              btn.onclick = () => removeUser(u)

              li.append(span, btn)
              userList.appendChild(li)
            })
          }
          updateStatus(
            statusMessage,
            `æˆ¿é—´ "${room}" ç™½åå•å·²åŠ è½½ã€‚`,
            'success',
          )
        } catch (e) {
          console.error('è·å–ç”¨æˆ·åˆ—è¡¨å¼‚å¸¸:', e)
          if (e.message.includes('404')) {
            updateStatus(
              statusMessage,
              'ç”¨æˆ·ç®¡ç†æœåŠ¡æœªå¯åŠ¨ï¼Œè¯·æ£€æŸ¥åç«¯é…ç½®',
              'error',
            )
          } else if (e.message.includes('401')) {
            updateStatus(statusMessage, 'æƒé™éªŒè¯å¤±è´¥ï¼Œè¯·æ£€æŸ¥ç®¡ç†å¯†é’¥', 'error')
          } else {
            updateStatus(statusMessage, `é”™è¯¯: ${e.message}`, 'error')
          }
        }
      }

      async function addUser() {
        const room = roomNameInput.value.trim()
        const u = newUserInput.value.trim()
        if (!room || !u)
          return updateStatus(statusMessage, 'è¯·è¾“å…¥æˆ¿é—´åå’Œç”¨æˆ·åï¼', 'error')
        if (!adminSecret)
          return updateStatus(
            statusMessage,
            'æ— æ³•æ‰§è¡Œæ“ä½œï¼Œç¼ºå°‘ secret',
            'error',
          )

        addUserBtn.disabled = true
        addUserBtn.textContent = 'æ·»åŠ ä¸­â€¦'
        try {
          const domain = `https://${apiDomain || 'api.yuangs.cc'}`
          console.log('æ·»åŠ ç”¨æˆ·:', { room, username: u, secret: adminSecret })

          const res = await fetch(
            `${domain}/api/users/add?roomName=${encodeURIComponent(room)}&secret=${adminSecret}`,
            {
              method: 'POST',
              headers: { 'Content-Type': 'application/json' },
              body: JSON.stringify({ username: u }),
            },
          )

          if (!res.ok) {
            const errorText = await res.text()
            console.error('æ·»åŠ ç”¨æˆ·å¤±è´¥:', errorText)
            throw new Error(errorText)
          }

          newUserInput.value = ''
          await fetchUsers()
          await fetchActivatedRooms()
          updateStatus(statusMessage, `æˆåŠŸæ·»åŠ ç”¨æˆ·: ${u}`, 'success')
        } catch (e) {
          console.error('æ·»åŠ ç”¨æˆ·å¼‚å¸¸:', e)
          if (e.message.includes('404')) {
            updateStatus(
              statusMessage,
              'ç”¨æˆ·ç®¡ç†æœåŠ¡æœªå¯åŠ¨ï¼Œè¯·æ£€æŸ¥åç«¯é…ç½®',
              'error',
            )
          } else if (e.message.includes('401')) {
            updateStatus(statusMessage, 'æƒé™éªŒè¯å¤±è´¥ï¼Œè¯·æ£€æŸ¥ç®¡ç†å¯†é’¥', 'error')
          } else if (e.message.includes('409')) {
            updateStatus(statusMessage, `ç”¨æˆ· ${u} å·²å­˜åœ¨äºç™½åå•ä¸­`, 'error')
          } else {
            updateStatus(statusMessage, `æ·»åŠ å¤±è´¥: ${e.message}`, 'error')
          }
        } finally {
          addUserBtn.disabled = false
          addUserBtn.textContent = 'æ·»åŠ '
        }
      }

      async function removeUser(u) {
        const room = roomNameInput.value.trim()
        if (!room || !adminSecret)
          return updateStatus(statusMessage, 'ç¼ºå°‘ room æˆ– secret', 'error')
        if (!confirm(`ç¡®è®¤ç§»é™¤ "${u}"ï¼Ÿ`)) return

        try {
          const domain = `https://${apiDomain || 'api.yuangs.cc'}`
          console.log('ç§»é™¤ç”¨æˆ·:', { room, username: u, secret: adminSecret })

          const res = await fetch(
            `${domain}/api/users/remove?roomName=${encodeURIComponent(room)}&secret=${adminSecret}`,
            {
              method: 'POST',
              headers: { 'Content-Type': 'application/json' },
              body: JSON.stringify({ username: u }),
            },
          )

          if (!res.ok) {
            const errorText = await res.text()
            console.error('ç§»é™¤ç”¨æˆ·å¤±è´¥:', errorText)
            throw new Error(errorText)
          }

          await fetchUsers()
          updateStatus(statusMessage, `æˆåŠŸç§»é™¤ç”¨æˆ·: ${u}`, 'success')
        } catch (e) {
          console.error('ç§»é™¤ç”¨æˆ·å¼‚å¸¸:', e)
          if (e.message.includes('404')) {
            updateStatus(
              statusMessage,
              'ç”¨æˆ·ç®¡ç†æœåŠ¡æœªå¯åŠ¨ï¼Œè¯·æ£€æŸ¥åç«¯é…ç½®',
              'error',
            )
          } else if (e.message.includes('401')) {
            updateStatus(statusMessage, 'æƒé™éªŒè¯å¤±è´¥ï¼Œè¯·æ£€æŸ¥ç®¡ç†å¯†é’¥', 'error')
          } else if (e.message.includes('404')) {
            updateStatus(statusMessage, `ç”¨æˆ· ${u} ä¸å­˜åœ¨äºç™½åå•ä¸­`, 'error')
          } else {
            updateStatus(statusMessage, `ç§»é™¤å¤±è´¥: ${e.message}`, 'error')
          }
        }
      }

      // =================================================================
      //  Event Listeners & Initial Load
      // =================================================================
      document.addEventListener('DOMContentLoaded', () => {
        if (!adminSecret) {
          document.body.innerHTML =
            '<h1>æœªæˆæƒè®¿é—®</h1><p>è¯·åœ¨URLä¸­æä¾›æ­£ç¡®çš„ç®¡ç†å¯†é’¥ (?secret=æ‚¨çš„å¯†é’¥)ã€‚</p>'
          return
        }
        initTheme()
        populateRoomSelects()
        switchTab('inspiration-management') // Default to inspiration tab

        // é¢„åŠ è½½å‘å¸ƒç®¡ç†ç›¸å…³æ•°æ®
        fetchPublishStats()
        fetchPublishResults()
        fetchPublishQueueStatus()

        // Bind user management events
        loadUsersBtn.onclick = fetchUsers
        addUserBtn.onclick = addUser

        // ä¸ºçŸ¥ä¹çµæ„Ÿè¾“å…¥æ¡†æ·»åŠ äº‹ä»¶ç›‘å¬å™¨
        const inspirationInput = document.getElementById(
          'inspiration-topic-input',
        )
        const inspirationClearBtn =
          inspirationInput?.parentElement?.querySelector('.input-clear-btn')

        if (inspirationInput && inspirationClearBtn) {
          // åˆå§‹åŒ–æ¸…é™¤æŒ‰é’®çŠ¶æ€
          inspirationClearBtn.style.display = inspirationInput.value
            ? 'flex'
            : 'none'

          // è¾“å…¥æ—¶æ˜¾ç¤º/éšè—æ¸…é™¤æŒ‰é’®
          inspirationInput.addEventListener('input', function () {
            inspirationClearBtn.style.display = this.value ? 'flex' : 'none'
          })

          // ç²˜è´´æ—¶æ˜¾ç¤º/éšè—æ¸…é™¤æŒ‰é’®
          inspirationInput.addEventListener('paste', function () {
            setTimeout(() => {
              inspirationClearBtn.style.display = this.value ? 'flex' : 'none'
            }, 10)
          })
        }
        
        // ä¸ºæ–°é—»è¾“å…¥æ¡†æ·»åŠ äº‹ä»¶ç›‘å¬å™¨
        const newsInput = document.getElementById('news-topic-input')
        const newsClearBtn = 
          newsInput?.parentElement?.querySelector('.input-clear-btn')
          
        if (newsInput && newsClearBtn) {
          // åˆå§‹åŒ–æ¸…é™¤æŒ‰é’®çŠ¶æ€
          newsClearBtn.style.display = newsInput.value
            ? 'flex'
            : 'none'

          // è¾“å…¥æ—¶æ˜¾ç¤º/éšè—æ¸…é™¤æŒ‰é’®
          newsInput.addEventListener('input', function () {
            newsClearBtn.style.display = this.value ? 'flex' : 'none'
          })

          // ç²˜è´´æ—¶æ˜¾ç¤º/éšè—æ¸…é™¤æŒ‰é’®
          newsInput.addEventListener('paste', function () {
            setTimeout(() => {
              newsClearBtn.style.display = this.value ? 'flex' : 'none'
            }, 10)
          })
        }
      })
    </script>
  </body>
</html>
